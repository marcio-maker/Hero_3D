<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfólio 3D - Óculos</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            overflow-x: hidden;
            height: 100vh;
        }

        .sections-container {
            position: relative;
            height: 100vh;
            width: 100%;
        }

        section {
            height: 100vh;
            width: 100%;
            display: flex;
            flex-direction: column; /* Alterado para coluna em mobile */
            align-items: center;
            justify-content: center; /* Centralizado verticalmente */
            padding: 20px;
            position: absolute;
            top: 0;
            left: 0;
            opacity: 0;
            transition: opacity 0.8s ease;
        }

        section.active {
            opacity: 1;
            z-index: 1;
        }

        section::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background:
                radial-gradient(circle at 20% 30%, rgba(255, 255, 255, 0.8) 1px, transparent 1px),
                radial-gradient(circle at 80% 70%, rgba(255, 255, 255, 0.8) 1px, transparent 1px),
                radial-gradient(circle at 50% 20%, rgba(255, 255, 255, 0.6) 1px, transparent 1px),
                linear-gradient(to bottom, #9cf6a5, #b5e0f1);
            background-size: 300px 300px, 400px 400px, 200px 200px, 100% 100%;
            z-index: -1;
        }

        .text-container {
            width: 100%; /* Ocupa toda a largura em mobile */
            text-align: center; /* Texto centralizado */
            margin-bottom: 20px; /* Espaço entre texto e modelo */
            z-index: 2;
        }

        .glasses-container {
            width: 100%; /* Ocupa toda a largura */
            height: 50vh; /* Altura reduzida para mobile */
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            background-color: transparent;
            touch-action: none; /* Permite interação touch com o modelo 3D */
        }

        .glasses-canvas {
            width: 100%;
            height: 100%;
            background-color: transparent;
        }

        h1 {
            font-size: 2rem; /* Tamanho reduzido para mobile */
            margin-bottom: 1rem;
            transform: translateX(100vw);
            opacity: 0;
            color: #333;
        }

        p {
            font-size: 1rem; /* Tamanho reduzido para mobile */
            line-height: 1.6;
            transform: translateX(100vw);
            opacity: 0;
            color: #555;
        }

        /* Navegação por pontos - reposicionada para mobile */
        .nav-dots {
            position: fixed;
            bottom: 20px; /* Movido para baixo em mobile */
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
            display: flex;
            flex-direction: row; /* Alinhados horizontalmente */
            gap: 15px;
        }

        .dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.2);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .dot.active {
            background: rgba(0, 0, 0, 0.6);
            transform: scale(1.3);
        }

        /* Loading indicator */
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #333;
            font-size: 1rem; /* Tamanho reduzido */
        }

        /* Media Queries para dispositivos maiores */
        @media (min-width: 768px) {
            section {
                flex-direction: row; /* Volta ao layout original em desktop */
                justify-content: space-between;
                padding: 0 5%;
            }

            .text-container {
                width: 40%; /* Largura original */
                text-align: left; /* Alinhamento original */
                margin-bottom: 0;
            }

            .glasses-container {
                width: 45%; /* Largura original */
                height: 80%; /* Altura original */
            }

            h1 {
                font-size: 3.5rem; /* Tamanho original */
            }

            p {
                font-size: 1.2rem; /* Tamanho original */
            }

            .nav-dots {
                top: 50%;
                bottom: auto;
                left: auto;
                right: 30px;
                transform: translateY(-50%);
                flex-direction: column; /* Volta à coluna em desktop */
            }
        }
    </style>
</head>

<body>
    <!-- O restante do seu HTML permanece igual -->
    <div class="sections-container">
        <!-- Seção 1 -->
        <section class="section-1 active">
            <div class="text-container">
                <h1 class="title-1">Design Inovador</h1>
                <p class="text-1">Explore nossos óculos com tecnologia de ponta.</p>
            </div>
            <div class="glasses-container" id="glasses-container-1">
                <canvas class="glasses-canvas" id="glasses-canvas-1"></canvas>
                <div class="loading" id="loading-1">Carregando modelo 3D...</div>
            </div>
        </section>

        <!-- Seção 2 -->
        <section class="section-2">
            <div class="text-container">
                <h1 class="title-2">Conforto Superior</h1>
                <p class="text-2">Materiais leves para uso prolongado.</p>
            </div>
            <div class="glasses-container" id="glasses-container-2">
                <canvas class="glasses-canvas" id="glasses-canvas-2"></canvas>
                <div class="loading" id="loading-2">Carregando modelo 3D...</div>
            </div>
        </section>

        <!-- Seção 3 -->
        <section class="section-3">
            <div class="text-container">
                <h1 class="title-3">Proteção Completa</h1>
                <p class="text-3">Lentes com proteção 100% UV.</p>
            </div>
            <div class="glasses-container" id="glasses-container-3">
                <canvas class="glasses-canvas" id="glasses-canvas-3"></canvas>
                <div class="loading" id="loading-3">Carregando modelo 3D...</div>
            </div>
        </section>
    </div>

    <!-- Navegação por pontos -->
    <div class="nav-dots">
        <div class="dot active" data-section="0"></div>
        <div class="dot" data-section="1"></div>
        <div class="dot" data-section="2"></div>
    </div>

    <!-- Scripts permanecem iguais -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.4/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.4/ScrollTrigger.min.js"></script>

    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.165.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.165.0/examples/jsm/"
            }
        }
    </script>

    <script type="module">
        // Configuração Three.js com ajustes para mobile
        async function setupThreeJS(sectionIndex) {
            const containerId = `glasses-container-${sectionIndex + 1}`;
            const canvasId = `glasses-canvas-${sectionIndex + 1}`;
            const loadingId = `loading-${sectionIndex + 1}`;

            const { Scene, PerspectiveCamera, WebGLRenderer, Color, AmbientLight,
                DirectionalLight, Box3, Vector3 } = await import('three');
            const { GLTFLoader } = await import('three/addons/loaders/GLTFLoader.js');
            const { OrbitControls } = await import('three/addons/controls/OrbitControls.js');

            // Elementos do DOM
            const container = document.getElementById(containerId);
            const canvas = document.getElementById(canvasId);
            const loadingElement = document.getElementById(loadingId);

            // Cena
            const scene = new Scene();
            scene.background = null;

            // Câmera - ajustada para mobile
            const camera = new PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000);
            camera.position.set(0, 0, 5);

            // Renderizador
            const renderer = new WebGLRenderer({
                canvas: canvas,
                antialias: true,
                alpha: true
            });
            renderer.setSize(container.clientWidth, container.clientHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2)); // Limita pixel ratio para performance

            // Luzes
            const ambientLight = new AmbientLight(0xffffff, 0.7);
            scene.add(ambientLight);

            const directionalLight1 = new DirectionalLight(0xffffff, 0.5);
            directionalLight1.position.set(10, 10, 10);
            scene.add(directionalLight1);

            const directionalLight2 = new DirectionalLight(0xffffff, 0.5);
            directionalLight2.position.set(-10, 10, -10);
            scene.add(directionalLight2);

            // Carregar modelo
            const loader = new GLTFLoader();
            let model, controls;

            const modelUrls = [
                './assets/sun_glasses_fbx_346kb.glb',
                './assets/party_glasses_heart_type.glb',
                './assets/glasses_09.glb'
            ];

            loader.load(
                modelUrls[sectionIndex],
                function (gltf) {
                    model = gltf.scene;
                    scene.add(model);
                    loadingElement.style.display = 'none';

                    // Centralizar modelo
                    const bbox = new Box3().setFromObject(model);
                    const center = bbox.getCenter(new Vector3());
                    const size = bbox.getSize(new Vector3());

                    model.position.x -= center.x;
                    model.position.y -= center.y;
                    model.position.z -= center.z;

                    // Ajustar câmera para mobile
                    const maxDim = Math.max(size.x, size.y, size.z);
                    const fov = camera.fov * (Math.PI / 180);
                    let cameraZ = Math.abs(maxDim / 2 / Math.tan(fov / 2));
                    cameraZ *= window.innerWidth < 768 ? 2 : 1.5; // Zoom maior em mobile
                    camera.position.z = cameraZ;

                    // Controles de órbita com ajustes para touch
                    controls = new OrbitControls(camera, canvas);
                    controls.target.set(0, 0, 0);
                    controls.enableDamping = true;
                    controls.dampingFactor = 0.25;
                    
                    // Ajustes para touch screen
                    controls.touchAction = 'none'; // Permite rolagem sem conflito
                    controls.enablePan = false; // Desativa pan para melhor experiência mobile
                    controls.maxPolarAngle = Math.PI * 0.9; // Limita rotação vertical

                    // Animação
                    function animate() {
                        requestAnimationFrame(animate);
                        if (controls) controls.update();
                        renderer.render(scene, camera);
                    }

                    animate();

                    // Redimensionamento responsivo
                    function onResize() {
                        camera.aspect = container.clientWidth / container.clientHeight;
                        camera.updateProjectionMatrix();
                        renderer.setSize(container.clientWidth, container.clientHeight);
                        
                        // Ajuste adicional para mobile
                        if (window.innerWidth < 768 && model) {
                            const bbox = new Box3().setFromObject(model);
                            const size = bbox.getSize(new Vector3());
                            const maxDim = Math.max(size.x, size.y, size.z);
                            const fov = camera.fov * (Math.PI / 180);
                            let cameraZ = Math.abs(maxDim / 2 / Math.tan(fov / 2));
                            cameraZ *= 2; // Zoom maior em mobile
                            camera.position.z = cameraZ;
                        }
                    }

                    window.addEventListener('resize', onResize);
                },
                function (xhr) {
                    const percentLoaded = (xhr.loaded / xhr.total * 100).toFixed(0);
                    loadingElement.textContent = `Carregando modelo 3D... ${percentLoaded}%`;
                },
                function (error) {
                    console.error('Erro ao carregar o modelo:', error);
                    loadingElement.textContent = 'Erro ao carregar o modelo 3D';
                    loadingElement.style.color = 'red';
                }
            );

            return { scene, camera, renderer };
        }

        // O restante do seu JavaScript permanece igual
        // ...
    </script>
</body>
</html>